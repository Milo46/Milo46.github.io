var C=Object.defineProperty;var p=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var u=(n,e,s)=>e in n?C(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,g=(n,e)=>{for(var s in e||(e={}))T.call(e,s)&&u(n,s,e[s]);if(p)for(var s of p(e))v.call(e,s)&&u(n,s,e[s]);return n};var t=(n,e,s)=>(u(n,typeof e!="symbol"?e+"":e,s),s);import{W as x,S as b,P as y,V as k,a as w,M as c,F as H,T as L,b as d,B as S,R as f,c as M,A as z,C as A,j as D,d as l,r as I,e as K,f as U}from"./vendor.601466c7.js";const _=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}};_();class N{constructor(){t(this,"scenes");t(this,"current");t(this,"has",e=>this.scenes.has(e));t(this,"get",e=>this.scenes.get(e));t(this,"set",(e,s)=>this.scenes.set(e,s));t(this,"delete",e=>{var s;this.scenes.get(e)===this.current&&(this.current=void 0),(s=this.scenes.get(e))==null||s.onDestruction(),this.scenes.delete(e)});t(this,"size",()=>this.scenes.size);t(this,"getCurrent",()=>this.current);t(this,"setCurrent",e=>{var i;const s=this.current;return this.scenes.has(e)?(s==null||s.onDestruction(),s==null||s.removeAll(),this.current=this.scenes.get(e),(i=this.current)==null||i.onInitialization({key:e}),this.current===void 0&&console.error("Something's wrong ups!"),!0):!1});this.scenes=new Map,this.current=void 0}}class O{constructor(e,s={}){t(this,"renderer");t(this,"sceneManager");t(this,"lastFrameScene");t(this,"deltaTime",0);t(this,"sceneTime",0);t(this,"lastTime",0);t(this,"isRunning");t(this,"running",()=>this.isRunning);t(this,"onInitialization",()=>{});t(this,"onDestruction",()=>{});t(this,"gameLoop",(e,s)=>{var i,r;this.sceneManager.getCurrent()===void 0&&(this.isRunning=!1,this.renderer.setAnimationLoop(null),this.renderer.clear()),this.deltaTime=(e-this.lastTime)/1e3,this.lastTime=e,this.sceneTime=this.lastFrameScene==this.sceneManager.getCurrent()?this.sceneTime+=this.deltaTime:0,this.lastFrameScene=this.sceneManager.getCurrent(),(i=this.sceneManager.getCurrent())==null||i.onUpdate({deltaTime:this.deltaTime,sceneTime:this.sceneTime,totalTime:e}),(r=this.sceneManager.getCurrent())==null||r.onRender({})});t(this,"run",()=>{this.isRunning=!0,this.renderer.setAnimationLoop(this.gameLoop)});this.renderer=new x(g({canvas:e},s)),this.renderer.setSize(innerWidth,innerHeight),this.sceneManager=new N,this.isRunning=!1}}class R extends b{constructor(e){super();t(this,"sceneParameters");t(this,"renderer");t(this,"sceneManager");t(this,"managerKey","no-key");t(this,"removeAll",()=>this.remove(this,...this.children));t(this,"onInitialization",async()=>{});t(this,"onDestruction",async()=>{});t(this,"onUpdate",()=>{});t(this,"onRender",()=>{});this.sceneParameters=e,this.renderer=this.sceneParameters.renderer,this.sceneManager=this.sceneParameters.sceneManager}}class P{constructor(){t(this,"keys");t(this,"buttons");t(this,"onKeyDown",e=>{this.keys[e.key]=!0});t(this,"onKeyUp",e=>{this.keys[e.key]=!1});t(this,"onMouseDown",e=>{this.buttons[e.button]=!0});t(this,"onMouseUp",e=>{this.buttons[e.button]=!1});t(this,"isKeyPressed",e=>this.keys[e]);t(this,"isButtonPressed",e=>this.buttons[e]);this.keys={},this.buttons={},document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("mouseup",this.onMouseUp)}}class W extends R{constructor(e){super(e);t(this,"ENTITY_HEIGHT",.3);t(this,"camera");t(this,"ground");t(this,"player");t(this,"keyHandler");t(this,"raycaster");t(this,"mousePosition");t(this,"cameraMatUpdateCallback");t(this,"onInitialization",e=>{this.managerKey=e.key});t(this,"onDestruction",()=>{window.removeEventListener("resize",this.cameraMatUpdateCallback)});t(this,"onUpdate",e=>{const i=3*e.deltaTime;this.keyHandler.isKeyPressed("ArrowUp")&&(this.player.position.z-=i),this.keyHandler.isKeyPressed("ArrowDown")&&(this.player.position.z+=i),this.keyHandler.isKeyPressed("ArrowLeft")&&(this.player.position.x-=i),this.keyHandler.isKeyPressed("ArrowRight")&&(this.player.position.x+=i),this.keyHandler.isKeyPressed("Escape")&&this.sceneManager.setCurrent("main-menu-scene")});t(this,"onRender",e=>{this.renderer.render(this,this.camera)});this.camera=new y(75,innerWidth/innerHeight,.1,1e3),this.camera.name="main-camera",this.camera.position.y=5,this.camera.position.x=2,this.camera.position.z=2,this.camera.lookAt(new k(0,0,0)),this.add(this.camera);const s=new w(10,10,10,1),i=new c({color:16777215,side:H,map:new L().load("resources/textures/ground.png",a=>console.log("Loaded ground texture!"),a=>console.log("Loading ground texture: "+a.loaded+"/"+a.total),a=>console.log("Error loading ground texture: "+a.message))});this.ground=new d(s,i),this.ground.rotation.x=-Math.PI/2,this.add(this.ground);const r=new S(1,this.ENTITY_HEIGHT,1),o=new c({color:65280});this.player=new d(r,o),this.player.position.y=r.parameters.height/2,this.add(this.player),this.keyHandler=new P,this.raycaster=new f,this.mousePosition=new M,this.cameraMatUpdateCallback=m.createPerspectiveCameraResizer(this.renderer,this.camera),window.addEventListener("resize",this.cameraMatUpdateCallback)}}class j extends R{constructor(e){super(e);t(this,"camera");t(this,"playButton");t(this,"restartButton");t(this,"creditsButton");t(this,"raycaster");t(this,"mousePosition");t(this,"keyHandler");t(this,"onInitialization",e=>{this.managerKey=e.key});t(this,"onDestruction",()=>{});t(this,"onUpdate",e=>{this.raycaster.setFromCamera(this.mousePosition,this.camera);const s=this.raycaster.intersectObject(this.playButton),i=this.raycaster.intersectObject(this.restartButton),r=this.raycaster.intersectObject(this.creditsButton);this.playButton.material=new c({color:s.length?65280:16711680}),this.restartButton.material=new c({color:i.length?65280:16711680}),this.creditsButton.material=new c({color:r.length?65280:16711680}),this.keyHandler.isButtonPressed("0")&&(s.length&&this.sceneManager.setCurrent("main-scene"),i.length&&this.sceneManager.setCurrent("main-scene"),r.length&&this.sceneManager.setCurrent("credits-scene"))});t(this,"onRender",e=>{this.renderer.render(this,this.camera)});this.camera=new y(100,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=10,this.add(this.camera);const s=new z(200);this.add(s);const i=new A("rgb(52, 152, 219)");this.renderer.setClearColor(i,.5);const r=new w(15,4,10,1),o=new c({color:"rgb(255, 255, 255)"});this.playButton=new d(r,o),this.restartButton=new d(r,o),this.creditsButton=new d(r,o),this.playButton.position.y=5,this.restartButton.position.y=0,this.creditsButton.position.y=-5,this.add(this.playButton,this.restartButton,this.creditsButton),this.raycaster=new f,this.mousePosition=new M,document.addEventListener("mousemove",this.onDocumentMouseMove.bind(this)),this.keyHandler=new P}onDocumentMouseMove(e){this.mousePosition.x=e.clientX/window.innerWidth*2-1,this.mousePosition.y=-(e.clientY/window.innerHeight)*2+1}}class m extends O{constructor(e){super(e,{antialias:!0});t(this,"onInitialization",()=>{this.sceneManager.setCurrent("main-scene")});this.sceneManager.set("main-scene",new W({renderer:this.renderer,sceneManager:this.sceneManager})),this.sceneManager.set("main-menu-scene",new j({renderer:this.renderer,sceneManager:this.sceneManager}))}}t(m,"createPerspectiveCameraResizer",(e,s)=>i=>{s.aspect=innerWidth/innerHeight,s.updateProjectionMatrix(),e.setSize(innerWidth,innerHeight)});const h=D.exports.jsx,G=()=>{const n=l.createRef();return I.exports.useEffect(()=>{var s;const e=new m((s=n.current)!=null?s:void 0);return e.onInitialization(),e.run(),()=>{e.onDestruction()}},[]),h("div",{children:h("canvas",{className:"canvas-three",ref:n})})},F=()=>h(l.StrictMode,{children:h(G,{})}),E=17,V=18,Y=E,B=()=>h(l.StrictMode,{children:h(F,{})}),q=n=>{K.exports.render(B(),n)},X=n=>{U(n).render(B())},J=(n,e)=>{switch(e){case E:q(n);break;case V:X(n);break;default:{console.error("Selected unsupported react version!");return}}},Q=()=>{const n=document.getElementById("root");if(n===null){console.error("Root container cannot be found!");return}J(n,Y)};Q();
