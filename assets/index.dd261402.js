var R=Object.defineProperty;var u=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var d=(n,e,r)=>e in n?R(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,m=(n,e)=>{for(var r in e||(e={}))T.call(e,r)&&d(n,r,e[r]);if(u)for(var r of u(e))E.call(e,r)&&d(n,r,e[r]);return n};var t=(n,e,r)=>(d(n,typeof e!="symbol"?e+"":e,r),r);import{W as x,S as v,P as y,V as C,a as P,M as g,F as k,T as S,b as p,B as L,R as z,c as A,C as I,j as H,d as h,r as b,e as _,f as D}from"./vendor.1378a71a.js";const U=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}};U();class N{constructor(){t(this,"scenes");t(this,"current");t(this,"has",e=>this.scenes.has(e));t(this,"get",e=>this.scenes.get(e));t(this,"set",(e,r)=>this.scenes.set(e,r));t(this,"delete",e=>{var r;this.scenes.get(e)===this.current&&(this.current=void 0),(r=this.scenes.get(e))==null||r.onDestruction(),this.scenes.delete(e)});t(this,"size",()=>this.scenes.size);t(this,"getCurrent",()=>this.current);t(this,"setCurrent",e=>{var i;const r=this.current;return this.scenes.has(e)?(r==null||r.onDestruction(),r==null||r.removeAll(),this.current=this.scenes.get(e),(i=this.current)==null||i.onInitialization({key:e}),this.current===void 0&&console.error("Something's wrong ups!"),!0):!1});this.scenes=new Map,this.current=void 0}}class K{constructor(e,r={}){t(this,"renderer");t(this,"sceneManager");t(this,"lastFrameScene");t(this,"deltaTime",0);t(this,"sceneTime",0);t(this,"lastTime",0);t(this,"isRunning");t(this,"running",()=>this.isRunning);t(this,"onInitialization",()=>{});t(this,"onDestruction",()=>{});t(this,"gameLoop",(e,r)=>{var i,s;this.sceneManager.getCurrent()===void 0&&(this.isRunning=!1,this.renderer.setAnimationLoop(null),this.renderer.clear()),this.deltaTime=(e-this.lastTime)/1e3,this.lastTime=e,this.sceneTime=this.lastFrameScene==this.sceneManager.getCurrent()?this.sceneTime+=this.deltaTime:0,this.lastFrameScene=this.sceneManager.getCurrent(),(i=this.sceneManager.getCurrent())==null||i.onUpdate({deltaTime:this.deltaTime,sceneTime:this.sceneTime,totalTime:e}),(s=this.sceneManager.getCurrent())==null||s.onRender({})});t(this,"run",()=>{this.isRunning=!0,this.renderer.setAnimationLoop(this.gameLoop)});this.renderer=new x(m({canvas:e},r)),this.renderer.setSize(innerWidth,innerHeight),this.sceneManager=new N,this.isRunning=!1}}class f extends v{constructor(e){super();t(this,"sceneParameters");t(this,"renderer");t(this,"sceneManager");t(this,"managerKey","no-key");t(this,"removeAll",()=>this.remove(this,...this.children));t(this,"onInitialization",async()=>{});t(this,"onDestruction",async()=>{});t(this,"onUpdate",()=>{});t(this,"onRender",()=>{});this.sceneParameters=e,this.renderer=this.sceneParameters.renderer,this.sceneManager=this.sceneParameters.sceneManager}}class W{constructor(){t(this,"keys");t(this,"onKeyDown",e=>{this.keys[e.key]=!0});t(this,"onKeyUp",e=>{this.keys[e.key]=!1});t(this,"isPressed",e=>this.keys[e]);this.keys={},document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp)}}class B extends f{constructor(e){super(e);t(this,"ENTITY_HEIGHT",.3);t(this,"camera");t(this,"ground");t(this,"player");t(this,"keyHandler");t(this,"raycaster");t(this,"mousePosition");t(this,"cameraMatUpdateCallback");t(this,"onInitialization",e=>{this.managerKey=e.key});t(this,"onDestruction",()=>{window.removeEventListener("resize",this.cameraMatUpdateCallback)});t(this,"onUpdate",e=>{const i=3*e.deltaTime;this.keyHandler.isPressed("ArrowUp")&&(this.player.position.z-=i),this.keyHandler.isPressed("ArrowDown")&&(this.player.position.z+=i),this.keyHandler.isPressed("ArrowLeft")&&(this.player.position.x-=i),this.keyHandler.isPressed("ArrowRight")&&(this.player.position.x+=i)});t(this,"onRender",e=>{this.renderer.render(this,this.camera)});this.camera=new y(75,innerWidth/innerHeight,.1,1e3),this.camera.name="main-camera",this.camera.position.y=5,this.camera.position.x=2,this.camera.position.z=2,this.camera.lookAt(new C(0,0,0)),this.add(this.camera);const r=new P(10,10,10,1),i=new g({color:16777215,side:k,map:new S().load("resources/textures/ground.png",o=>console.log("Loaded ground texture!"),o=>console.log("Loading ground texture: "+o.loaded+"/"+o.total),o=>console.log("Error loading ground texture: "+o.message))});this.ground=new p(r,i),this.ground.rotation.x=-Math.PI/2,this.add(this.ground);const s=new L(1,this.ENTITY_HEIGHT,1),a=new g({color:65280});this.player=new p(s,a),this.player.position.y=s.parameters.height/2,this.add(this.player),this.keyHandler=new W,this.raycaster=new z,this.mousePosition=new A,this.cameraMatUpdateCallback=l.createPerspectiveCameraResizer(this.renderer,this.camera),window.addEventListener("resize",this.cameraMatUpdateCallback)}}class G extends f{constructor(e){super(e);t(this,"camera");t(this,"button");t(this,"onInitialization",e=>{this.managerKey=e.key});t(this,"onDestruction",()=>{});t(this,"onUpdate",e=>{});t(this,"onRender",e=>{this.renderer.render(this,this.camera)});this.camera=new y(75,window.innerWidth/window.innerHeight,.1,1e3),this.add(this.camera);const r=new I(255);this.renderer.setClearColor(r)}}class l extends K{constructor(e){super(e,{antialias:!0});t(this,"onInitialization",()=>{this.sceneManager.setCurrent("main-menu-scene")});this.sceneManager.set("main-scene",new B({renderer:this.renderer,sceneManager:this.sceneManager})),this.sceneManager.set("main-menu-scene",new G({renderer:this.renderer,sceneManager:this.sceneManager}))}}t(l,"createPerspectiveCameraResizer",(e,r)=>i=>{r.aspect=innerWidth/innerHeight,r.updateProjectionMatrix(),e.setSize(innerWidth,innerHeight)});const c=H.exports.jsx,O=()=>{const n=h.createRef();return b.exports.useEffect(()=>{var r;const e=new l((r=n.current)!=null?r:void 0);return e.onInitialization(),e.run(),()=>{e.onDestruction()}},[]),c("div",{children:c("canvas",{className:"canvas-three",ref:n})})},F=()=>c(h.StrictMode,{children:c(O,{})}),w=17,V=18,j=w,M=()=>c(h.StrictMode,{children:c(F,{})}),Y=n=>{_.exports.render(M(),n)},q=n=>{D(n).render(M())},J=(n,e)=>{switch(e){case w:Y(n);break;case V:q(n);break;default:{console.error("Selected unsupported react version!");return}}},Q=()=>{const n=document.getElementById("root");if(n===null){console.error("Root container cannot be found!");return}J(n,j)};Q();
