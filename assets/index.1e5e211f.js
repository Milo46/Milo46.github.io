var E=Object.defineProperty;var y=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var m=(n,e,s)=>e in n?E(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,f=(n,e)=>{for(var s in e||(e={}))P.call(e,s)&&m(n,s,e[s]);if(y)for(var s of y(e))b.call(e,s)&&m(n,s,e[s]);return n};var t=(n,e,s)=>(m(n,typeof e!="symbol"?e+"":e,s),s);import{W as C,S as T,P as w,V as x,a as M,M as u,F as z,T as L,b as l,B as S,R as D,c as A,j as I,d as p,r as k,e as U,f as N}from"./vendor.3cc4932c.js";const O=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function s(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(r){if(r.ep)return;r.ep=!0;const c=s(r);fetch(r.href,c)}};O();class W{constructor(){t(this,"scenes");t(this,"current");t(this,"has",e=>this.scenes.has(e));t(this,"get",e=>this.scenes.get(e));t(this,"set",(e,s)=>this.scenes.set(e,s));t(this,"delete",e=>{var s;this.scenes.get(e)===this.current&&(this.current=void 0),(s=this.scenes.get(e))==null||s.onDestruction(),this.scenes.delete(e)});t(this,"size",()=>this.scenes.size);t(this,"getCurrent",()=>this.current);t(this,"setCurrent",e=>{var i;const s=this.current;return this.scenes.has(e)?(s==null||s.onDestruction(),s==null||s.removeAll(),this.current=this.scenes.get(e),(i=this.current)==null||i.onInitialization({key:e}),this.current===void 0&&console.error("Something's wrong ups!"),!0):!1});this.scenes=new Map,this.current=void 0}}const a=class{constructor(){}};let o=a;t(o,"keys",{}),t(o,"buttons",{}),t(o,"initialized",!1),t(o,"onKeyDown",e=>a.keys[e.key]=!0),t(o,"onKeyUp",e=>a.keys[e.key]=!1),t(o,"onButtonDown",e=>a.buttons[e.button]=!0),t(o,"onButtonUp",e=>a.buttons[e.button]=!1),t(o,"initialize",()=>{a.initialized||(a.initialized=!0,document.addEventListener("keydown",a.onKeyDown),document.addEventListener("keyup",a.onKeyUp),document.addEventListener("mousedown",a.onButtonDown),document.addEventListener("mouseup",a.onButtonUp))}),t(o,"isKeyPressed",e=>a.keys[e]),t(o,"isButtonPressed",e=>a.buttons[e]);class j{constructor(e,s={}){t(this,"renderer");t(this,"sceneManager");t(this,"lastFrameScene");t(this,"deltaTime",0);t(this,"sceneTime",0);t(this,"lastTime",0);t(this,"isRunning");t(this,"running",()=>this.isRunning);t(this,"onInitialization",()=>{});t(this,"onDestruction",()=>{});t(this,"gameLoop",(e,s)=>{var i,r;this.sceneManager.getCurrent()===void 0&&(this.isRunning=!1,this.renderer.setAnimationLoop(null),this.renderer.clear()),this.deltaTime=(e-this.lastTime)/1e3,this.lastTime=e,this.sceneTime=this.lastFrameScene==this.sceneManager.getCurrent()?this.sceneTime+=this.deltaTime:0,this.lastFrameScene=this.sceneManager.getCurrent(),(i=this.sceneManager.getCurrent())==null||i.onUpdate({deltaTime:this.deltaTime,sceneTime:this.sceneTime,totalTime:e}),(r=this.sceneManager.getCurrent())==null||r.onRender({})});t(this,"run",()=>{this.isRunning=!0,this.renderer.setAnimationLoop(this.gameLoop)});this.renderer=new C(f({canvas:e},s)),this.renderer.setSize(innerWidth,innerHeight),this.sceneManager=new W,this.isRunning=!1,o.initialize()}}class R extends T{constructor(e){super();t(this,"sceneParameters");t(this,"renderer");t(this,"sceneManager");t(this,"managerKey","no-key");t(this,"removeAll",()=>this.remove(this,...this.children));t(this,"onInitialization",async()=>{});t(this,"onDestruction",async()=>{});t(this,"onUpdate",()=>{});t(this,"onRender",()=>{});this.sceneParameters=e,this.renderer=this.sceneParameters.renderer,this.sceneManager=this.sceneParameters.sceneManager}}class G extends R{constructor(e){super(e);t(this,"ENTITY_HEIGHT",.2);t(this,"camera");t(this,"ground");t(this,"player");t(this,"cameraMatUpdateCallback");t(this,"onInitialization",e=>{this.managerKey=e.key,window.addEventListener("resize",this.cameraMatUpdateCallback),this.add(this.ground),this.add(this.player),this.player.add(this.camera)});t(this,"onDestruction",()=>{window.removeEventListener("resize",this.cameraMatUpdateCallback)});t(this,"onUpdate",e=>{const i=3*e.deltaTime;o.isKeyPressed("ArrowUp")&&(this.player.position.z-=i),o.isKeyPressed("ArrowDown")&&(this.player.position.z+=i),o.isKeyPressed("ArrowLeft")&&(this.player.position.x-=i),o.isKeyPressed("ArrowRight")&&(this.player.position.x+=i),o.isKeyPressed("Escape")&&this.sceneManager.setCurrent("main-menu-scene")});t(this,"onRender",e=>{this.renderer.render(this,this.camera)});this.camera=new w(75,innerWidth/innerHeight,.1,1e3),this.camera.name="main-camera",this.camera.position.y=5,this.camera.position.z=2,this.camera.lookAt(new x(0,0,0));const s=new M(10,10,10,1),i=new u({color:16777215,side:z,map:new L().load("/resources/textures/ground.png",h=>console.log("Loaded ground texture!"),h=>console.log("Loading ground texture: "+h.loaded+"/"+h.total),h=>console.log("Error loading ground texture: "+h.message))});this.ground=new l(s,i),this.ground.name="ground",this.ground.rotation.x=-Math.PI/2;const r=new S(1,this.ENTITY_HEIGHT,1),c=new u({color:65280});this.player=new l(r,c),this.player.name="player",this.player.position.y=r.parameters.height/2,this.cameraMatUpdateCallback=g.createPerspectiveCameraResizer(this.renderer,this.camera)}}class F extends R{constructor(e){super(e);t(this,"camera");t(this,"playButton");t(this,"restartButton");t(this,"creditsButton");t(this,"buttons");t(this,"raycaster");t(this,"mousePosition");t(this,"cameraMatUpdateCallback");t(this,"onInitialization",e=>{this.managerKey=e.key,document.addEventListener("mousemove",this.onDocumentMouseMove.bind(this)),this.add(this.playButton,this.restartButton,this.creditsButton),this.renderer.setClearColor("rgb(52, 152, 219)",.5)});t(this,"onDestruction",()=>{document.removeEventListener("mousemove",this.onDocumentMouseMove.bind(this)),this.renderer.setClearColor("rgb(0, 0, 0)",1)});t(this,"onUpdate",e=>{this.raycaster.setFromCamera(this.mousePosition,this.camera);const s=this.raycaster.intersectObject(this.playButton),i=this.raycaster.intersectObject(this.restartButton),r=this.raycaster.intersectObject(this.creditsButton);this.playButton.material=new u({color:s.length?65280:16711680}),this.restartButton.material=new u({color:i.length?65280:16711680}),this.creditsButton.material=new u({color:r.length?65280:16711680}),o.isButtonPressed(0)&&(s.length&&this.sceneManager.setCurrent("main-scene"),i.length&&this.sceneManager.setCurrent("main-scene"),r.length&&this.sceneManager.setCurrent("credits-scene"))});t(this,"onRender",e=>{this.renderer.render(this,this.camera)});this.camera=new w(100,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=10,this.add(this.camera);const s=new M(15,4,10,1),i=new u({color:"rgb(255, 255, 255)"});this.playButton=new l(s,i),this.restartButton=new l(s,i),this.creditsButton=new l(s,i),this.playButton.position.y=5,this.restartButton.position.y=0,this.creditsButton.position.y=-5,this.raycaster=new D,this.mousePosition=new A}onDocumentMouseMove(e){this.mousePosition.x=e.clientX/window.innerWidth*2-1,this.mousePosition.y=-(e.clientY/window.innerHeight)*2+1,console.log(this.mousePosition)}}class g extends j{constructor(e){super(e,{antialias:!0});t(this,"onInitialization",()=>{this.sceneManager.setCurrent("main-menu-scene")});this.sceneManager.set("main-scene",new G({renderer:this.renderer,sceneManager:this.sceneManager})),this.sceneManager.set("main-menu-scene",new F({renderer:this.renderer,sceneManager:this.sceneManager}))}}t(g,"createPerspectiveCameraResizer",(e,s)=>i=>{s.aspect=innerWidth/innerHeight,s.updateProjectionMatrix(),e.setSize(innerWidth,innerHeight)});const d=I.exports.jsx,V=()=>{const n=p.createRef();return k.exports.useEffect(()=>{var s;const e=new g((s=n.current)!=null?s:void 0);return e.onInitialization(),e.run(),()=>{e.onDestruction()}},[]),d("div",{children:d("canvas",{className:"canvas-three",ref:n})})},K=()=>d(p.StrictMode,{children:d(V,{})}),B=17,Y=18,_=B,v=()=>d(p.StrictMode,{children:d(K,{})}),q=n=>{U.exports.render(v(),n)},X=n=>{N(n).render(v())},J=(n,e)=>{switch(e){case B:q(n);break;case Y:X(n);break;default:{console.error("Selected unsupported react version!");return}}},Q=()=>{const n=document.getElementById("root");if(n===null){console.error("Root container cannot be found!");return}J(n,_)};Q();
